(()=>{"use strict";var t,e={1366:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.createDiagnosticsForError=e.TransformerError=void 0;class r extends Error{constructor(t,e){super(t),this.node=e}fillNodeIfEmpty(t){var e;this.node=null!==(e=this.node)&&void 0!==e?e:t}}e.TransformerError=r,e.createDiagnosticsForError=function(t,e){var r,n;const{message:i,node:o}=t,s=null==o?void 0:o.getSourceFile(),a=`[Types2schema] ${i}`;return{category:e.DiagnosticCategory.Error,code:-1001,file:s,start:null!==(r=null==o?void 0:o.getStart(s))&&void 0!==r?r:1,messageText:a,length:null!==(n=null==o?void 0:o.getText().length)&&void 0!==n?n:0}}},9304:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.getAnnotationReaderSingleton=void 0;const n=r(1727);class i{constructor(t){this.ts=t}getAnnotationsFromDeclaration(t){var e;const r=null!==(e=this.tryGetJsDocFromDeclaration(t))&&void 0!==e?e:this.ts.JsDoc.getJsDocTagsFromDeclarations([t]),n=this.parseJsDocTags(r);return Object.keys(n).length?n:void 0}getAnnotationsFromType(t){const e=(0,n.getDeclarationFromType)(t);if(e)return this.getAnnotationsFromDeclaration(e)}getAnnotationsFromSymbol(t){var e;const r=(0,n.getDeclarationFromSymbol)(t),i=null!==(e=this.tryGetJsDocFromDeclaration(r))&&void 0!==e?e:t.getJsDocTags();if(!i||!i.length)return;const o=this.parseJsDocTags(i);return Object.keys(o).length?o:void 0}tryGetJsDocFromDeclaration(t){var e,r,n;try{return null===(n=null===(r=null===(e=t)||void 0===e?void 0:e.jsDoc)||void 0===r?void 0:r[0].tags)||void 0===n?void 0:n.map((t=>{var e,r,n;return{name:t.tagName.getText(),text:null!==(e=t.comment)&&void 0!==e?e:null===(n=null===(r=t)||void 0===r?void 0:r.typeExpression)||void 0===n?void 0:n.getText()}}))}catch(t){return null}}parseJsDocTags(t){return t.reduce(((t,e)=>{const r=this.parseJsDocTagValue(e);return void 0!==r&&(t[e.name]=r),t}),{})}parseJsDocTagValue(t){const e=t.text;if(!e)return!0;try{return JSON.parse(e)}catch(t){return e}}}let o=null;e.getAnnotationReaderSingleton=t=>(o||(o=new i(t)),o)},5694:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.AnnotationEntity=void 0;const n=r(6846);class i extends n.BaseEntity{constructor(t,e,r){super(r),this.entity=t,this.annotations=e}getId(){return this.entity.getId()}getEntity(){return this.entity}getAnnotations(){return this.annotations}}e.AnnotationEntity=i},895:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.AnyEntity=void 0;const n=r(6846);class i extends n.BaseEntity{getId(){return"any"}}e.AnyEntity=i},7954:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.ArrayEntity=void 0;const n=r(6846);class i extends n.BaseEntity{constructor(t,e){super(e),this.item=t}getItem(){return this.item}}e.ArrayEntity=i},6846:function(t,e){var r=this&&this.__rest||function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]])}return r};Object.defineProperty(e,"__esModule",{value:!0}),e.BaseEntity=void 0,e.BaseEntity=class{constructor(t){this.tsMeta=t}getId(){return this.tsMeta.type.id.toString()}toJSON(){const{tsMeta:t}=this,e=r(this,["tsMeta"]);return Object.assign({entityType:Object.getPrototypeOf(this).constructor.name,id:this.getId(),name:this.getDefinitionName()},e)}getDefinitionName(){return this.getId()}}},1796:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.BooleanEntity=void 0;const n=r(3256);class i extends n.PrimitiveEntity{getId(){return"boolean"}}e.BooleanEntity=i},2251:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.DefinitionEntity=void 0;const n=r(6846);class i extends n.BaseEntity{constructor(){super(...arguments),this.entity=null,this.id=null,this.name=null}getId(){if(null==this.id)throw new Error("Reference type ID not set yet");return this.id}setId(t){this.id=t}getDefinitionName(){if(null==this.name)throw new Error("Reference type name not set yet");return this.name}setName(t){this.name=t}getEntity(){if(null==this.entity)throw new Error("Reference type not set yet");return this.entity}setEntity(t){this.entity=t,this.setId(t.getId()),this.setName(t.getDefinitionName())}}e.DefinitionEntity=i},1832:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.EnumEntity=void 0;const n=r(6846);class i extends n.BaseEntity{constructor(t,e){super(e),this.entities=t}getValues(){return this.entities.map((t=>t.getValue()))}getEntities(){return this.entities}}e.EnumEntity=i},9475:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.LiteralEntity=void 0;const n=r(6846);class i extends n.BaseEntity{constructor(t,e){super(e),this.value=t}getValue(){return this.value}}e.LiteralEntity=i},4644:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.NullEntity=void 0;const n=r(3256);class i extends n.PrimitiveEntity{getId(){return"null"}}e.NullEntity=i},192:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.NumberEntity=void 0;const n=r(3256);class i extends n.PrimitiveEntity{getId(){return"number"}}e.NumberEntity=i},5069:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.ObjectEntity=e.ObjectProperty=void 0;const n=r(6846),i=r(32),o=r(7329);e.ObjectProperty=class{constructor(t,e,r){this.name=t,this.entity=e,this.required=r}getName(){return(0,o.strip)(this.name)}getEntity(){return this.entity}isRequired(){return this.required}};class s extends n.BaseEntity{constructor(t,e,r){super(r),this.properties=t,this.additionalProperties=e}getDefinitionName(){var t;try{const e=null!==(t=this.tsMeta.type.aliasSymbol)&&void 0!==t?t:this.tsMeta.type.symbol;return`${(0,i.formatQualifiedName)(this.tsMeta.type.checker.getFullyQualifiedName(e))}(${super.getDefinitionName()})`}catch(t){return super.getDefinitionName()}}getProperties(){return this.properties}getAdditionalProperties(){return this.additionalProperties}}e.ObjectEntity=s},3256:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PrimitiveEntity=void 0;const n=r(6846);class i extends n.BaseEntity{}e.PrimitiveEntity=i},7248:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.StringEntity=void 0;const n=r(3256);class i extends n.PrimitiveEntity{getId(){return"string"}}e.StringEntity=i},9010:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.TupleEntity=e.TupleElement=void 0;const n=r(6846);e.TupleElement=class{constructor(t,e,r){this.entity=t,this.elementFlag=e,this.ts=r}getEntity(){return this.entity}isRequired(){return!!(this.elementFlag&this.ts.ElementFlags.Required)}isOptional(){return!!(this.elementFlag&this.ts.ElementFlags.Optional)}isRest(){return!!(this.elementFlag&this.ts.ElementFlags.Rest)}};class i extends n.BaseEntity{constructor(t,e){super(e),this.elements=t}getElements(){return this.elements}}e.TupleEntity=i},9660:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.UndefinedEntity=void 0;const n=r(6846);class i extends n.BaseEntity{getId(){return"undefined"}}e.UndefinedEntity=i},6581:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.UnionEntity=void 0;const n=r(6846),i=r(2741);class o extends n.BaseEntity{constructor(t,e){super(e),this.entities=(0,i.uniqueEntityArray)(t.reduce(((t,e)=>(e instanceof o?t.push(...e.getEntities()):void 0!==e&&t.push(e),t)),[]))}getEntities(){return this.entities}}e.UnionEntity=o},1667:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.FormatterCacheDecorator=void 0;const n=r(2741);e.FormatterCacheDecorator=class{constructor(t){this.formatter=t,this.definition=new Map,this.children=new Map}support(t){return this.formatter.support(t)}getDefinition(t){if(this.definition.has(t))return this.definition.get(t);const e={};return this.definition.set(t,e),Object.assign(e,this.formatter.getDefinition(t)),e}getChildren(t){if(this.children.has(t))return this.children.get(t);const e=[];return this.children.set(t,e),e.push(...this.formatter.getChildren(t)),(0,n.uniqueArray)(e)}}},8389:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.ChainFormatter=void 0;const n=r(1366);e.ChainFormatter=class{constructor(){this.formatters=[]}addFormatter(t){return this.formatters.push(t),this}support(t){return this.formatters.some((e=>e.support(t)))}getDefinition(t){return this.getSupportFormatter(t).getDefinition(t)}getChildren(t){return this.getSupportFormatter(t).getChildren(t)}getSupportFormatter(t){const e=this.formatters.find((e=>e.support(t)));if(!e)throw new n.TransformerError("Not find supported formatter, it's an unexpected error, please contact maintainers.");return e}}},640:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.AnnotationEntityFormatter=void 0;const n=r(5694);e.AnnotationEntityFormatter=class{constructor(t){this.formatter=t}support(t){return t instanceof n.AnnotationEntity}getDefinition(t){return Object.assign(Object.assign({},this.formatter.getDefinition(t.getEntity())),t.getAnnotations())}getChildren(t){return this.formatter.getChildren(t.getEntity())}}},2316:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.AnyEntityFormatter=void 0;const n=r(895);e.AnyEntityFormatter=class{support(t){return t instanceof n.AnyEntity}getDefinition(t){return{}}getChildren(t){return[]}}},7099:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.ArrayEntityFormatter=void 0;const n=r(7954);e.ArrayEntityFormatter=class{constructor(t){this.formatter=t}support(t){return t instanceof n.ArrayEntity}getDefinition(t){return{type:"array",items:this.formatter.getDefinition(t.getItem())}}getChildren(t){return this.formatter.getChildren(t.getItem())}}},4173:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.BooleanEntityFormatter=void 0;const n=r(1796);e.BooleanEntityFormatter=class{support(t){return t instanceof n.BooleanEntity}getDefinition(){return{type:"boolean"}}getChildren(){return[]}}},7089:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.DefinitionEntityFormatter=void 0;const n=r(2251),i=r(2741);e.DefinitionEntityFormatter=class{constructor(t){this.formatter=t}support(t){return t instanceof n.DefinitionEntity}getDefinition(t){return{$ref:`#/definitions/${t.getDefinitionName()}`}}getChildren(t){return(0,i.uniqueArray)([t,...this.formatter.getChildren(t.getEntity())])}}},5887:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.EnumFormatter=void 0;const n=r(1832),i=r(4769),o=r(2741);e.EnumFormatter=class{support(t){return t instanceof n.EnumEntity}getDefinition(t){const e=(0,o.uniqueArray)(t.getValues()),r=(0,i.groupBy)(e,(t=>typeof t));return{anyOf:[...Object.keys(r).map((t=>({type:t,enum:r[t]})))]}}getChildren(t){return[]}}},7154:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.LiteralEntityFormatter=void 0;const n=r(9475);e.LiteralEntityFormatter=class{support(t){return t instanceof n.LiteralEntity}getDefinition(t){const e=t.getValue();return{type:typeof e,enum:[e]}}getChildren(){return[]}}},4347:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.NullEntityFormatter=void 0;const n=r(4644);e.NullEntityFormatter=class{support(t){return t instanceof n.NullEntity}getDefinition(){return{type:"null"}}getChildren(){return[]}}},3830:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.NumberEntityFormatter=void 0;const n=r(192);e.NumberEntityFormatter=class{support(t){return t instanceof n.NumberEntity}getDefinition(){return{type:"number"}}getChildren(){return[]}}},9393:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.ObjectEntityFormatter=void 0;const n=r(6846),i=r(5069),o=r(9660),s=r(6581),a=r(6836),c=r(4425),u=r(7502),l=r(432),d=r(2741);e.ObjectEntityFormatter=class{constructor(t){this.formatter=t}support(t){return t instanceof i.ObjectEntity}prepareObjectProperty(t){const e=t.getEntity(),r=(0,a.derefEntity)(e);if(r instanceof o.UndefinedEntity)return;if(!(r instanceof s.UnionEntity))return t;const{hasRemoved:n,newEntity:c}=(0,l.removeUndefinedEntity)(r);return n?new i.ObjectProperty(t.getName(),(0,u.preserveAnnotation)(e,c),!1):t}getDefinition(t){const e=t.getProperties(),r=t.getAdditionalProperties(),n=e.map((t=>this.prepareObjectProperty(t))).filter(c.notUndefined),i=n.filter((t=>t.isRequired())).map((t=>t.getName()));return{type:"object",properties:n.reduce(((t,e)=>{const r=e.getEntity();return void 0!==r&&(t[e.getName()]=this.formatter.getDefinition(r)),t}),{}),required:i,additionalProperties:"boolean"==typeof r?r:this.formatter.getDefinition(r)}}getChildren(t){const e=t.getProperties(),r=t.getAdditionalProperties(),i=r instanceof n.BaseEntity?this.formatter.getChildren(r):[],o=e.map((t=>this.prepareObjectProperty(t))).reduce(((t,e)=>{if(!e)return t;const r=e.getEntity();return r?[...t,...this.formatter.getChildren(r)]:t}),[]);return(0,d.uniqueArray)([...i,...o])}}},3244:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.StringEntityFormatter=void 0;const n=r(7248);e.StringEntityFormatter=class{support(t){return t instanceof n.StringEntity}getDefinition(){return{type:"string"}}getChildren(){return[]}}},5423:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.TupleEntityFormatter=void 0;const n=r(1366),i=r(9010),o=r(6836),s=r(432),a=r(2741);e.TupleEntityFormatter=class{constructor(t){this.formatter=t}support(t){return t instanceof i.TupleEntity}getDefinition(t){const e=t.getElements(),r=e.filter((t=>t.isRequired())),i=e.filter((t=>t.isOptional())),a=e.filter((t=>t.isRest())),c=a.length>0;if(c&&a.length>1)throw new n.TransformerError("Can't create schema for tuple which has more than one restType",t.tsMeta.node);if(c&&e.indexOf(a[0])!==e.length-1)throw new n.TransformerError("Can't create schema for tuple where restType is not trailing",t.tsMeta.node);const u=c?a[0].getEntity():void 0,l=r.map((t=>this.formatter.getDefinition(t.getEntity()))),d=i.map((t=>this.formatter.getDefinition((0,s.removeUndefinedEntity)((0,o.derefEntity)(t.getEntity())).newEntity))),y=r.length+i.length;return Object.assign(Object.assign(Object.assign({type:"array",minItems:r.length},y?{items:[...l,...d]}:{}),u?{additionalItems:this.formatter.getDefinition(u)}:{}),!u&&y?{maxItems:y}:{})}getChildren(t){return(0,a.uniqueArray)(t.getElements().reduce(((t,e)=>{const r=e.isOptional()?(0,s.removeUndefinedEntity)((0,o.derefEntity)(e.getEntity())).newEntity:e.getEntity();return[...t,...this.formatter.getChildren(r)]}),[]))}}},2471:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.UndefinedEntityFormatter=void 0;const n=r(1366),i=r(9660);e.UndefinedEntityFormatter=class{support(t){return t instanceof i.UndefinedEntity}getDefinition(t){throw new n.TransformerError("Undefined is not a transformed type.")}getChildren(t){throw new n.TransformerError("Undefined is not a transformed type.")}}},9206:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.UnionEntityFormatter=void 0;const n=r(6581),i=r(2741);e.UnionEntityFormatter=class{constructor(t){this.formatter=t}support(t){return t instanceof n.UnionEntity}getDefinition(t){return{anyOf:t.getEntities().map((t=>this.formatter.getDefinition(t)))}}getChildren(t){return(0,i.uniqueArray)(t.getEntities().reduce(((t,e)=>[...t,...this.formatter.getChildren(e)]),[]))}}},9015:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.createFormatter=void 0;const n=r(1667),i=r(8389),o=r(640),s=r(2316),a=r(7099),c=r(4173),u=r(7089),l=r(5887),d=r(7154),y=r(4347),p=r(3830),f=r(9393),h=r(3244),m=r(5423),g=r(2471),E=r(9206);e.createFormatter=function(t){const e=new i.ChainFormatter,r=new n.FormatterCacheDecorator(e);return e.addFormatter(new o.AnnotationEntityFormatter(r)).addFormatter(new g.UndefinedEntityFormatter).addFormatter(new h.StringEntityFormatter).addFormatter(new p.NumberEntityFormatter).addFormatter(new c.BooleanEntityFormatter).addFormatter(new y.NullEntityFormatter).addFormatter(new s.AnyEntityFormatter).addFormatter(new d.LiteralEntityFormatter).addFormatter(new l.EnumFormatter).addFormatter(new u.DefinitionEntityFormatter(r)).addFormatter(new f.ObjectEntityFormatter(r)).addFormatter(new a.ArrayEntityFormatter(r)).addFormatter(new m.TupleEntityFormatter(r)).addFormatter(new E.UnionEntityFormatter(r)),r}},7764:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.createGenerator=e.SchemaGenerator=void 0;const n=r(2251),i=r(9015),o=r(6386),s=r(1366);class a{constructor(t,e){this.parser=t,this.formatter=e}onRootEntityCreated(t,e){}createSchema(t,e){const r=this.parser.createEntity(t);if(this.onRootEntityCreated(r,e),!r)throw new s.TransformerError("Can't convert root node or type to entity",e);const n=this.formatter.getDefinition(r),i={};return this.appendChildrenDefinitions(r,i),Object.assign(Object.assign({$schema:"http://json-schema.org/draft-07/schema#"},null!=n?n:{}),{definitions:i})}appendChildrenDefinitions(t,e){const r=new Set;this.formatter.getChildren(t).filter((t=>t instanceof n.DefinitionEntity)).filter((t=>{const e=r.has(t.getId());return e||r.add(t.getId()),!e})).reduce(((t,e)=>{const r=e.getDefinitionName();return r in t||(t[r]=this.formatter.getDefinition(e.getEntity())),t}),e)}}e.SchemaGenerator=a,e.createGenerator=function(t,e=a){return new e((0,o.createParser)(t),(0,i.createFormatter)(t))}},6386:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.createParser=void 0;const n=r(5257),i=r(3630),o=r(8038),s=r(1230),a=r(444),c=r(5794),u=r(2615),l=r(8066),d=r(6338),y=r(276),p=r(9379),f=r(4119),h=r(58),m=r(593),g=r(1525),E=r(5607),v=r(2893);e.createParser=function(t){const{typeChecker:e,transformerExtras:{ts:r}}=t,P=new i.ChainParser;function b(t){return new n.TypeAnnotationParser(t,r)}function O(t){return new o.ParserReuseDecorator(t)}return P.addParser(new s.AnyTypeParser(r)).addParser(new p.NullTypeParser(r)).addParser(new E.UndefinedTypeParser(r)).addParser(new c.BooleanTypeParser(r)).addParser(new m.StringTypeParser(r)).addParser(new f.NumberTypeParser(r)).addParser(new d.LiteralTypeNodeParser(r)).addParser(O(b(new u.EnumParser(r)))).addParser(b(new v.UnionParser(e,P,r))).addParser(O(b(new l.IntersectionParser(e,P,r)))).addParser(O(b(new y.MappedObjectParser(e,P,r)))).addParser(O(b(new h.ObjectParser(e,P,r)))).addParser(b(new g.TupleTypeParser(e,P,r))).addParser(b(new a.ArrayTypeParser(P,e,r))),P}},5257:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.TypeAnnotationParser=void 0;const n=r(1727),i=r(2289);e.TypeAnnotationParser=class{constructor(t,e){this.childParser=t,this.ts=e}supports(t){return this.childParser.supports(t)}createEntity(t){const e=this.childParser.createEntity(t),r=(0,n.getDeclarationFromType)(t);return r?(0,i.wrapAnnotationByDeclaration)(e,r,this.ts):e}}},3630:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.ChainParser=void 0;const n=r(1366);e.ChainParser=class{constructor(){this.parsers=[]}addParser(t){return this.parsers.push(t),this}supports(t){return this.parsers.some((e=>e.supports(t)))}createEntity(t){return this.getSupportedParser(t).createEntity(t)}getSupportedParser(t){for(const e of this.parsers)if(e.supports(t))return e;throw new n.TransformerError(`Unsupported Type: ${t.checker.typeToString(t)}`)}}},8038:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.ParserReuseDecorator=void 0;const n=r(2251),i=r(1727);e.ParserReuseDecorator=class{constructor(t){this.childParser=t,this.store=new Map}supports(t){return this.childParser.supports(t)}createEntity(t){const e=t.id,r=(0,i.getDeclarationFromType)(t);if(!this.store.has(e)){const i=new n.DefinitionEntity({type:t,node:r});this.store.set(e,i);const o=this.childParser.createEntity(t);i.setEntity(o)}return this.store.get(e)}}},1230:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.AnyTypeParser=void 0;const n=r(895);e.AnyTypeParser=class{constructor(t){this.ts=t}supports(t){return t.flags===this.ts.TypeFlags.Any&&"error"!==t.intrinsicName}createEntity(t){return new n.AnyEntity({type:t})}}},444:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.ArrayTypeParser=void 0;const n=r(1366),i=r(7954);e.ArrayTypeParser=class{constructor(t,e,r){this.childParser=t,this.typeChecker=e,this.ts=r}supports(t){return this.typeChecker.isArrayType(t)&&!!(t.objectFlags&this.ts.ObjectFlags.Reference)}createEntity(t){const e=t.node,r=t.typeArguments?t.typeArguments[0]:void 0;if(!r)throw new n.TransformerError("Illegal Array Node Type",e);const o=this.childParser.createEntity(r);return new i.ArrayEntity(o,{node:e,type:t})}}},5794:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.BooleanTypeParser=void 0;const n=r(1796);e.BooleanTypeParser=class{constructor(t){this.ts=t}supports(t){return!!(t.flags&this.ts.TypeFlags.Boolean)}createEntity(t){return new n.BooleanEntity({type:t})}}},2615:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.EnumParser=void 0;const n=r(1832),i=r(9475),o=r(1727);e.EnumParser=class{constructor(t){this.ts=t}supports(t){return!!(t.flags&this.ts.TypeFlags.EnumLike)}createEntity(t){const e=t.types.map((t=>{const e=t.value;return new i.LiteralEntity(e,{type:t,node:t.symbol.valueDeclaration})})),r=(0,o.getDeclarationFromType)(t);return new n.EnumEntity(e,{node:r,type:t})}}},8066:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.IntersectionParser=void 0;const n=r(5069),i=r(1727),o=r(4425),s=r(2289);e.IntersectionParser=class{constructor(t,e,r){this.typeChecker=t,this.childParser=e,this.ts=r}supports(t){return t.isIntersection()}createEntity(t){const e=this.typeChecker.getPropertiesOfType(t).map((e=>{const r=e.flags&this.ts.SymbolFlags.Optional,i=this.typeChecker.getTypeOfPropertyOfType(t,e.name);if(!i)return;const o=this.childParser.createEntity(i);return new n.ObjectProperty(e.name,(0,s.wrapAnnotationBySymbol)(o,e,this.ts),!r)})).filter(o.notUndefined);return new n.ObjectEntity(e,this.getAdditionalProperties(t),{node:(0,i.getDeclarationFromType)(t),type:t})}getAdditionalProperties(t){var e,r;const n=this.ts.IndexKind,i=null!==(e=this.typeChecker.getIndexInfoOfType(t,n.Number))&&void 0!==e?e:this.typeChecker.getIndexInfoOfType(t,n.String);return!!i&&(0,s.wrapAnnotationBySymbol)(this.childParser.createEntity(i.type),null===(r=i.declaration)||void 0===r?void 0:r.symbol,this.ts)}}},6338:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.LiteralTypeNodeParser=void 0;const n=r(9475);e.LiteralTypeNodeParser=class{constructor(t){this.ts=t}supports(t){const e=this.ts.TypeFlags;return!!(t.flags&e.BooleanLiteral||t.flags&e.StringLiteral||t.flags&e.NumberLiteral)}createEntity(t){const e=this.ts.TypeFlags,r=t.flags&e.Intrinsic?"true"===t.intrinsicName:t.value;return new n.LiteralEntity(r,{type:t})}}},276:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.MappedObjectParser=void 0;const n=r(1366),i=r(1832),o=r(9475),s=r(192),a=r(5069),c=r(7248),u=r(6581),l=r(6836),d=r(4425);e.MappedObjectParser=class{constructor(t,e,r){this.typeChecker=t,this.childParser=e,this.ts=r}supports(t){return t.flags===this.ts.TypeFlags.Object&&t.objectFlags===this.ts.ObjectFlags.Mapped}createEntity(t){const e=t.declaration,r=e.typeParameter.constraint,d=this.typeChecker.getTypeAtLocation(r),y=(0,l.derefEntity)(this.childParser.createEntity(d));if(y instanceof u.UnionEntity)return new a.ObjectEntity(this.getPropertiesFromUnion(e,y),this.getAdditionalPropertiesFromUnion(e,y),{node:e,type:t});if(y instanceof o.LiteralEntity)return new a.ObjectEntity([new a.ObjectProperty(y.getValue().toString(),this.getMappedValueTypeEntity(e),!e.questionToken)],!1,{node:e,type:t});if(y instanceof c.StringEntity||y instanceof s.NumberEntity)return new a.ObjectEntity([],this.getMappedValueTypeEntity(e),{node:e,type:t});if(y instanceof i.EnumEntity)return new a.ObjectEntity(this.getPropertiesFromEnum(e,y),!1,{node:e,type:t});throw new n.TransformerError(`Unexpected mapped type keys:${this.typeChecker.typeToString(d)}`,e)}getMappedValueTypeEntity(t){const e=t.type,r=this.typeChecker.getTypeAtLocation(e);return this.childParser.createEntity(r)}getPropertiesFromUnion(t,e){const r=this.getMappedValueTypeEntity(t);return e.getEntities().filter((t=>t instanceof o.LiteralEntity)).reduce(((e,n)=>{const i=new a.ObjectProperty(n.getValue().toString(),r,!t.questionToken);return e.push(i),e}),[])}getPropertiesFromEnum(t,e){return e.getValues().filter(d.notUndefined).map((e=>new a.ObjectProperty(e.toString(),this.getMappedValueTypeEntity(t),!t.questionToken)))}getAdditionalPropertiesFromUnion(t,e){return!!e.getEntities().find((t=>!(t instanceof o.LiteralEntity)))&&this.getMappedValueTypeEntity(t)}}},9379:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.NullTypeParser=void 0;const n=r(4644);e.NullTypeParser=class{constructor(t){this.ts=t}supports(t){return t.flags===this.ts.TypeFlags.Null}createEntity(t){return new n.NullEntity({type:t})}}},4119:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.NumberTypeParser=void 0;const n=r(192);e.NumberTypeParser=class{constructor(t){this.ts=t}supports(t){return!!(t.flags&this.ts.TypeFlags.Number)}createEntity(t){return new n.NumberEntity({type:t})}}},58:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.ObjectParser=void 0;const n=r(5069),i=r(1727),o=r(2289);e.ObjectParser=class{constructor(t,e,r){this.typeChecker=t,this.childParser=e,this.ts=r}supports(t){return t.flags===this.ts.TypeFlags.Object&&!this.typeChecker.isArrayLikeType(t)}createEntity(t){const e=this.getProperties(t),r=this.getAdditionalProperties(t);return new n.ObjectEntity(e,r,{node:(0,i.getDeclarationFromType)(t),type:t})}getProperties(t){return this.typeChecker.getPropertiesOfType(t).filter((t=>t.flags&this.ts.SymbolFlags.Property)).map((t=>{var e;const{name:r}=t,s=null!==(e=(0,i.getDeclarationFromSymbol)(t))&&void 0!==e?e:t.mappedType.declaration,a=!(null==s?void 0:s.questionToken),c=this.typeChecker.getTypeOfSymbolAtLocation(t,s),u=this.childParser.createEntity(c),l=(0,o.wrapAnnotationBySymbol)(u,t,this.ts);return new n.ObjectProperty(r,l,a)}))}getAdditionalProperties(t){var e,r;const n=this.ts.IndexKind,i=null!==(e=this.typeChecker.getIndexInfoOfType(t,n.Number))&&void 0!==e?e:this.typeChecker.getIndexInfoOfType(t,n.String);return!!i&&(0,o.wrapAnnotationBySymbol)(this.childParser.createEntity(i.type),null===(r=i.declaration)||void 0===r?void 0:r.symbol,this.ts)}}},593:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.StringTypeParser=void 0;const n=r(7248);e.StringTypeParser=class{constructor(t){this.ts=t}supports(t){return!!(t.flags&this.ts.TypeFlags.String)}createEntity(t){return new n.StringEntity({type:t})}}},1525:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.TupleTypeParser=void 0;const n=r(9010),i=r(1727);e.TupleTypeParser=class{constructor(t,e,r){this.typeChecker=t,this.childParser=e,this.ts=r}supports(t){return this.typeChecker.isTupleType(t)}createEntity(t){var e,r;const o=null!==(r=null===(e=t.resolvedTypeArguments)||void 0===e?void 0:e.map(((e,r)=>({elementType:e,elementFlag:t.target.elementFlags[r]}))))&&void 0!==r?r:[];return new n.TupleEntity(o.map((({elementType:t,elementFlag:e})=>{const r=this.childParser.createEntity(t);return new n.TupleElement(r,e,this.ts)})),{node:(0,i.getDeclarationFromType)(t),type:t})}}},5607:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.UndefinedTypeParser=void 0;const n=r(9660);e.UndefinedTypeParser=class{constructor(t){this.ts=t}supports(t){return t.flags===this.ts.TypeFlags.Undefined}createEntity(t){return new n.UndefinedEntity({type:t})}}},2893:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.UnionParser=void 0;const n=r(6581),i=r(1727),o=r(4425);e.UnionParser=class{constructor(t,e,r){this.typeChecker=t,this.childParser=e,this.ts=r}supports(t){return t.isUnion()}createEntity(t){const e=t.types.map((t=>this.childParser.createEntity(t))).filter(o.notUndefined);return new n.UnionEntity(e,{node:(0,i.getDeclarationFromType)(t),type:t})}}},1727:(t,e)=>{function r(t){var e,r;return null!==(e=null==t?void 0:t.valueDeclaration)&&void 0!==e?e:null===(r=null==t?void 0:t.declarations)||void 0===r?void 0:r[0]}Object.defineProperty(e,"__esModule",{value:!0}),e.getDeclarationFromType=e.getDeclarationFromSymbol=void 0,e.getDeclarationFromSymbol=r,e.getDeclarationFromType=function(t){var e;return r(null!==(e=t.aliasSymbol)&&void 0!==e?e:t.symbol)}},6836:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.derefAnnotationEntity=e.derefEntity=void 0;const n=r(5694),i=r(2251);e.derefEntity=function t(e){return e instanceof i.DefinitionEntity||e instanceof n.AnnotationEntity?t(e.getEntity()):e},e.derefAnnotationEntity=function t(e){return e instanceof n.AnnotationEntity?t(e.getEntity()):e}},32:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.formatQualifiedName=void 0;const r=new RegExp("\\/","g"),n=/^-/,i=/"/g;e.formatQualifiedName=function(t){return t.replace(r,"-").replace(i,"").replace(n,"")}},4769:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.groupBy=void 0,e.groupBy=function(t,e){const r={};return t.reduce(((t,r)=>{const n=e(r);return t[n]=t[n]||[],t[n].push(r),t}),r),r}},4425:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.notUndefined=void 0,e.notUndefined=function(t){return void 0!==t}},7502:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.preserveAnnotation=void 0;const n=r(5694);e.preserveAnnotation=function(t,e){return t instanceof n.AnnotationEntity?new n.AnnotationEntity(e,t.getAnnotations(),t.tsMeta):e}},432:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.removeUndefinedEntity=void 0;const n=r(6836),i=r(7502),o=r(9660),s=r(6581);e.removeUndefinedEntity=function t(e){const r=[];let a=!1;for(const c of e.getEntities()){const e=(0,n.derefAnnotationEntity)(c);if(e instanceof o.UndefinedEntity)a=!0;else if(e instanceof s.UnionEntity){const n=t(e);a=a||n.hasRemoved,r.push((0,i.preserveAnnotation)(c,n.newEntity))}else r.push(c)}return{hasRemoved:a,newEntity:0==r.length?new o.UndefinedEntity(e.tsMeta):1==r.length?r[0]:new s.UnionEntity(r,e.tsMeta)}}},7329:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.strip=void 0;const r=new Set(["'",'"']);e.strip=function(t,e=r){const n=t.length,i=t.charAt(0),o=t.charAt(n-1);return n>=2&&i===o&&e.has(i)?t.substring(1,n-1):t}},2741:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.uniqueArray=e.uniqueEntityArray=void 0,e.uniqueEntityArray=function(t){const e=new Map;for(const r of t)e.set(r.getId(),r);return Array.from(e.values())},e.uniqueArray=function(t){return t.reduce(((t,e)=>(t.indexOf(e)<0&&t.push(e),t)),[])}},2289:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.wrapAnnotationByDeclaration=e.wrapAnnotationBySymbol=void 0;const n=r(9304),i=r(5694);e.wrapAnnotationBySymbol=function(t,e,r){const o=(0,n.getAnnotationReaderSingleton)(r),s=e?o.getAnnotationsFromSymbol(e):null;return s?new i.AnnotationEntity(t,s,t.tsMeta):t},e.wrapAnnotationByDeclaration=function(t,e,r){const o=(0,n.getAnnotationReaderSingleton)(r),s=e?o.getAnnotationsFromDeclaration(e):null;return s?new i.AnnotationEntity(t,s,t.tsMeta):t}},8644:(t,e,r)=>{e.X8=void 0;const n=r(1366),i=r(7764),o=r(8967);function s(t,r,i){return i.visitEachChild(function(t,r){const{typeChecker:i,schemaGenerator:s,transformerExtras:{ts:a}}=r;if(!function(t,r){return!(!r.isCallExpression(t)||!r.isIdentifier(t.expression))&&t.expression.getText()===e.X8}(t,a))return t;try{if(!t.typeArguments)throw new n.TransformerError("'schema' 方法必须传递类型参数",t);const e=t.typeArguments[0],r=i.getTypeFromTypeNode(e),c=s.createSchema(r,e);return(0,o.transformObjectToExpression)(c,a)}catch(e){if(!(e instanceof n.TransformerError))throw e;{e.fillNodeIfEmpty(t);const i=(0,n.createDiagnosticsForError)(e,a);r.transformerExtras.addDiagnostic(i)}}return t}(t,r),(t=>s(t,r,i)),r.transformationContext)}e.X8="schema",e.ZP=function(t,e,r){return n=>{const o={program:t,typeChecker:t.getTypeChecker(),transformationContext:n,pluginConfig:e,transformerExtras:r};return t=>s(t,Object.assign(Object.assign({},o),{schemaGenerator:(0,i.createGenerator)(o)}),r.ts)}}},8967:(t,e)=>{function r(t,e){return e.createSourceFile("",`return ${t}`,e.ScriptTarget.Latest).statements[0].expression}Object.defineProperty(e,"__esModule",{value:!0}),e.transformObjectToExpression=e.parseCodeToExpression=void 0,e.parseCodeToExpression=r,e.transformObjectToExpression=function(t,e){return r(JSON.stringify(t),e)}}},r={};t=function t(n){var i=r[n];if(void 0!==i)return i.exports;var o=r[n]={exports:{}};return e[n].call(o.exports,o,o.exports,t),o.exports}(8644),self.customTSWorkerFactory=(e,r)=>class extends e{createMockDiagnosticExtras(t){const e=[];return{addDiagnostic:t=>e.push(t),removeDiagnostic:t=>e.splice(t,1),diagnostics:e}}getCustomTransformers(){const e=this._languageService.getProgram();if(!e)return{};const n=this.createMockDiagnosticExtras(e);return{before:[(0,t.ZP)(e,{},{ts:r,library:"monaco-typescript-service",...n})]}}async getDTSEmitForFile(t){const e=(await this.getEmitOutput(t)).outputFiles.find((t=>t.name.endsWith(".d.ts")));return e&&e.text||""}}})();